<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>night_horizons.image_processing.operators module &#8212; night-horizons-mapmaker 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-night_horizons.image_processing.operators">
<span id="night-horizons-image-processing-operators-module"></span><h1>night_horizons.image_processing.operators module<a class="headerlink" href="#module-night_horizons.image_processing.operators" title="Link to this heading">¶</a></h1>
<p>Module for performing isolated operations on images, using only the images
and not considering any metadata.</p>
<dl class="py class">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.BaseImageOperator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">night_horizons.image_processing.operators.</span></span><span class="sig-name descname"><span class="pre">BaseImageOperator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.BaseImageOperator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="night_horizons.utils.html#night_horizons.utils.LoggerMixin" title="night_horizons.utils.LoggerMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggerMixin</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for image operators—classes that perform an operation on
two images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.BaseImageOperator.operate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">operate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.BaseImageOperator.operate" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method for performing an operation on two images.</p>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">numpy.ndarray</span></dt><dd><p>The source image on which the operation will be performed.</p>
</dd>
<dt>dst_img<span class="classifier">numpy.ndarray</span></dt><dd><p>The destination image where the result of the operation will be stored.</p>
</dd>
</dl>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>dict</dt><dd><p>Results dictionary.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">night_horizons.image_processing.operators.</span></span><span class="sig-name descname"><span class="pre">ImageAligner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_detector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Feature2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_matcher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DescriptorMatcher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transformer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="night_horizons.transformers.raster.html#night_horizons.transformers.raster.BaseImageTransformer" title="night_horizons.transformers.raster.BaseImageTransformer"><span class="pre">BaseImageTransformer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_brightness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_bright_pixel_area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_matches_used</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_homography_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'method':</span> <span class="pre">8,</span> <span class="pre">'ransacReprojThreshold':</span> <span class="pre">5.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['abs_det_M',</span> <span class="pre">'duration']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#night_horizons.image_processing.operators.BaseImageOperator" title="night_horizons.image_processing.operators.BaseImageOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseImageOperator</span></code></a></p>
<p>Class for aligning a source image with a destination image based on
the features detected in the images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.detect_and_compute">
<span class="sig-name descname"><span class="pre">detect_and_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">KeyPoint</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.detect_and_compute" title="Link to this definition">¶</a></dt>
<dd><p>Detect and compute feature-matching keypoints in an image,
as well as their descriptors.</p>
<section id="id1">
<h2>Parameters<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>img: np.ndarray</dt><dd><p>Input image to detect keypoitns for.</p>
</dd>
</dl>
</section>
<section id="id2">
<h2>Returns<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>tuple[list[cv2.KeyPoint], list[np.ndarray]]:</dt><dd><p>The detected keypoints and their descriptors.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.find_homography">
<span class="sig-name descname"><span class="pre">find_homography</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_kp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">KeyPoint</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_kp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">KeyPoint</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_des</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.find_homography" title="Link to this definition">¶</a></dt>
<dd><p>Find the homography transform between the source and destination images.</p>
<section id="id3">
<h2>Parameters<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_kp<span class="classifier">list[cv2.KeyPoint]</span></dt><dd><p>List of keypoints in the source image.</p>
</dd>
<dt>src_des<span class="classifier">list[np.ndarray]</span></dt><dd><p>List of descriptors in the source image.</p>
</dd>
<dt>dst_kp<span class="classifier">list[cv2.KeyPoint]</span></dt><dd><p>List of keypoints in the destination image.</p>
</dd>
<dt>dst_des<span class="classifier">list[np.ndarray]</span></dt><dd><p>List of descriptors in the destination image.</p>
</dd>
</dl>
</section>
<section id="id4">
<h2>Returns<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>np.ndarray</dt><dd><p>The homography matrix representing the transformation between
the source and destination images.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.find_valid_homography">
<span class="sig-name descname"><span class="pre">find_valid_homography</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.find_valid_homography" title="Link to this definition">¶</a></dt>
<dd><p>Find a valid homography transform between the source image and
the destination image. Raises an error if there is no valid homography.</p>
<section id="id5">
<h2>Parameters<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">np.ndarray</span></dt><dd><p>The source image.</p>
</dd>
<dt>dst_img<span class="classifier">np.ndarray</span></dt><dd><p>The destination image.</p>
</dd>
</dl>
</section>
<section id="id6">
<h2>Returns<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>dict</dt><dd><p>A dictionary containing the following results:
- M : Homography transform.
- src_kp : Keypoints for the source image.
- src_des : Keypoint descriptors for the source image.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.operate">
<span class="sig-name descname"><span class="pre">operate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.operate" title="Link to this definition">¶</a></dt>
<dd><p>Align the src_img with the dst_img.</p>
<section id="id7">
<h2>Parameters<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">numpy.ndarray</span></dt><dd><p>The source image to be aligned.</p>
</dd>
<dt>dst_img<span class="classifier">numpy.ndarray</span></dt><dd><p>The destination image to align the source image with.</p>
</dd>
</dl>
</section>
<section id="id8">
<h2>Returns<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h2>
<dl>
<dt>dict</dt><dd><p>The results dictionary containing the following keys:
- ‘warped_image’: The warped source image aligned with the</p>
<blockquote>
<div><p>destination image.</p>
</div></blockquote>
<ul class="simple">
<li><p>‘warped_bounds’: The bounding box of the warped image.</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.validate_brightness">
<span class="sig-name descname"><span class="pre">validate_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'src'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.validate_brightness" title="Link to this definition">¶</a></dt>
<dd><p>Check if the image is bright enough to perform feature matching on.</p>
<section id="id9">
<h2>Parameters<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>img<span class="classifier">np.ndarray</span></dt><dd><p>The input image to be validated.</p>
</dd>
<dt>error_type<span class="classifier">str, optional</span></dt><dd><p>The type of error to raise if the image is not bright enough (i.e. is
this an error with the source or the destination).Default is ‘src’.</p>
</dd>
</dl>
</section>
<section id="raises">
<h2>Raises<a class="headerlink" href="#raises" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>exceptions.SrcDarkFrameError or exceptions.DstDarkFrameError or KeyError</dt><dd><p>If the image does not meet the required brightness criteria.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.validate_homography">
<span class="sig-name descname"><span class="pre">validate_homography</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.validate_homography" title="Link to this definition">¶</a></dt>
<dd><p>Check if the homography matrix is valid, i.e. it will not result in extreme
warping when applied.</p>
<section id="id10">
<h2>Parameters<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>M<span class="classifier">np.ndarray</span></dt><dd><p>The homography matrix to be validated.</p>
</dd>
</dl>
</section>
<section id="id11">
<h2>Raises<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>HomographyTransformError</dt><dd><p>If the transform matrix M is None or if the determinant of M is outside the
specified range.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.validate_warp">
<span class="sig-name descname"><span class="pre">validate_warp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.validate_warp" title="Link to this definition">¶</a></dt>
<dd><p>Check if a warp is valid.</p>
<p>This method checks if the specified warp is valid by ensuring that the
destination image frame is not exceeded. The viable range in the destination
image frame is (0, dst_img.shape[1]) in the x-direction, and
(0, dst_img.shape[0]) in the y-direction.</p>
<section id="id12">
<h2>Parameters<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>dst_img<span class="classifier">np.ndarray</span></dt><dd><p>The destination image frame.</p>
</dd>
<dt>x_off<span class="classifier">int</span></dt><dd><p>The x-coordinate offset of the warp.</p>
</dd>
<dt>y_off<span class="classifier">int</span></dt><dd><p>The y-coordinate offset of the warp.</p>
</dd>
<dt>x_size<span class="classifier">int</span></dt><dd><p>The width of the warp.</p>
</dd>
<dt>y_size<span class="classifier">int</span></dt><dd><p>The height of the warp.</p>
</dd>
</dl>
</section>
<section id="id13">
<h2>Raises<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>exceptions.OutOfBoundsError</dt><dd><p>If the warp results in an out-of-bounds image.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.warp">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">warp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.warp" title="Link to this definition">¶</a></dt>
<dd><p>Warp the source image using a perspective transformation matrix.</p>
<section id="id14">
<h2>Parameters<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">np.ndarray</span></dt><dd><p>The source image to be warped.</p>
</dd>
<dt>dst_img<span class="classifier">np.ndarray</span></dt><dd><p>The destination image where the warped image will be placed.</p>
</dd>
<dt>M<span class="classifier">np.ndarray</span></dt><dd><p>The perspective transformation matrix.</p>
</dd>
</dl>
</section>
<section id="id15">
<h2>Returns<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>np.ndarray</dt><dd><p>The warped image.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAligner.warp_bounds">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">warp_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAligner.warp_bounds" title="Link to this definition">¶</a></dt>
<dd><p>Warp the bounds of the source image to get the bounds of the
warped image in the frame of the destination image.</p>
<section id="id16">
<h2>Parameters<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">np.ndarray</span></dt><dd><p>The source image to be warped.</p>
</dd>
<dt>M<span class="classifier">np.ndarray</span></dt><dd><p>The transformation matrix used for warping.</p>
</dd>
</dl>
</section>
<section id="id17">
<h2>Returns<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>list[int]</dt><dd><p>A list containing the x offset, y offset, width, and height of the
warped image in the frame of the destination image.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAlignerBlender">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">night_horizons.image_processing.operators.</span></span><span class="sig-name descname"><span class="pre">ImageAlignerBlender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_detector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Feature2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_matcher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DescriptorMatcher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transformer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="night_horizons.transformers.raster.html#night_horizons.transformers.raster.BaseImageTransformer" title="night_horizons.transformers.raster.BaseImageTransformer"><span class="pre">BaseImageTransformer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_brightness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_bright_pixel_area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_matches_used</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_homography_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'method':</span> <span class="pre">8,</span> <span class="pre">'ransacReprojThreshold':</span> <span class="pre">5.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['abs_det_M',</span> <span class="pre">'duration']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAlignerBlender" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#night_horizons.image_processing.operators.ImageAligner" title="night_horizons.image_processing.operators.ImageAligner"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageAligner</span></code></a>, <a class="reference internal" href="#night_horizons.image_processing.operators.ImageBlender" title="night_horizons.image_processing.operators.ImageBlender"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBlender</span></code></a></p>
<p>Class for first aligning a src image with a dst image, and then blending
the two.</p>
<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageAlignerBlender.operate">
<span class="sig-name descname"><span class="pre">operate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageAlignerBlender.operate" title="Link to this definition">¶</a></dt>
<dd><p>Perform image alignment and blending.</p>
<section id="id18">
<h2>Parameters<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">np.ndarray</span></dt><dd><p>The source image to be aligned and blended.</p>
</dd>
<dt>dst_img<span class="classifier">np.ndarray</span></dt><dd><p>The destination image onto which the source image will be blended.</p>
</dd>
</dl>
</section>
<section id="id19">
<h2>Returns<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>dict</dt><dd><p>A dictionary containing the results of the image alignment and blending.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageBlender">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">night_horizons.image_processing.operators.</span></span><span class="sig-name descname"><span class="pre">ImageBlender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageBlender" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#night_horizons.image_processing.operators.BaseImageOperator" title="night_horizons.image_processing.operators.BaseImageOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseImageOperator</span></code></a></p>
<p>Class for combining two images by filling empty space in the dst image
with the src image. No averaging is performed.</p>
<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageBlender.blend">
<span class="sig-name descname"><span class="pre">blend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageBlender.blend" title="Link to this definition">¶</a></dt>
<dd><p>Blend images together, filling empty space in the destination image
with the source image.</p>
<section id="id20">
<h2>Parameters<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">np.ndarray</span></dt><dd><p>The source image to blend into the destination image.</p>
</dd>
<dt>dst_img<span class="classifier">np.ndarray</span></dt><dd><p>The destination image where the source image will be blended.</p>
</dd>
</dl>
</section>
<section id="id21">
<h2>Returns<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>np.ndarray</dt><dd><p>The blended image.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageBlender.operate">
<span class="sig-name descname"><span class="pre">operate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageBlender.operate" title="Link to this definition">¶</a></dt>
<dd><p>Perform the blending operation.</p>
<p>This method takes in a source image and a destination image, and performs
the blending operation. It resizes the source image to match the dimensions
of the destination image, and then blends the two images together using the
<cite>blend</cite> method.</p>
<section id="id22">
<h2>Parameters<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">np.ndarray</span></dt><dd><p>The source image to be blended.</p>
</dd>
<dt>dst_img<span class="classifier">np.ndarray</span></dt><dd><p>The destination image.</p>
</dd>
</dl>
</section>
<section id="id23">
<h2>Returns<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>dict</dt><dd><p>A dictionary containing the blended image.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageOperatorQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">night_horizons.image_processing.operators.</span></span><span class="sig-name descname"><span class="pre">ImageOperatorQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">defaults</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageOperatorQueue" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for operating on images using a queue of image operators.
The first image operator in the queue attempts to analyze one image.
If it fails, the next image operator in the queue is used, and so on.</p>
<dl class="py method">
<dt class="sig sig-object py" id="night_horizons.image_processing.operators.ImageOperatorQueue.operate">
<span class="sig-name descname"><span class="pre">operate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#night_horizons.image_processing.operators.ImageOperatorQueue.operate" title="Link to this definition">¶</a></dt>
<dd><p>Perform the operations in order, until one succeeds.</p>
<section id="id24">
<h2>Parameters<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>src_img<span class="classifier">np.ndarray</span></dt><dd><p>The source image on which the operations will be performed.</p>
</dd>
<dt>dst_img<span class="classifier">np.ndarray</span></dt><dd><p>The destination image where the result of the operations will be stored.</p>
</dd>
</dl>
</section>
<section id="id25">
<h2>Returns<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>tuple</dt><dd><p>A tuple containing the result code, the result image, and a log dictionary.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">night-horizons-mapmaker</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data-flow.html">Data flow</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Zachary Hafen-Saavedra.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/night_horizons.image_processing.operators.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>